<div id="content-user">
	<div id="title">
		<div id="center">
			<div id="left">
				<img src='<%= @user.image %>' onerror="if (this.src != 'https://cdn.intra.42.fr/users/medium_default.png') this.src = 'https://cdn.intra.42.fr/users/medium_default.png';">
				<input id="id" type="hidden" maxlenght="10" value="<%= @user.id %>" >
			</div>
			<div id="right">
				<div id="name">
					<% if (@current == 1 || @admin == 1)%>
						<h1 class="username"><%= @user.nickname %> <i id="modif_username" class="fas fa-pen"></i></h1>
						<div id="container">
							<input class="username_input" type="text" maxlenght="30" placeholder="New username...">
							<i id="confirm_modif_username" class="fas fa-check"></i>
							<i id="cancel_modif_username" class="fas fa-times fa-times-switch"></i>
						</div>
					<% else %>
						<h1 class="username"><%= @user.nickname %></h1>
					<% end %>
					<h3><%= !@user.guild_id ? "NO GUILD" : @guild.name %></h3>
				</div>
			</div>
		</div>
	</div>
	<div id="corp">
		<% if @current != 0 %>
			<div id="element">
				<div id="name">
					<h2>2fa</h2>
				</div>
				<div id="container">
					<%= content_tag :div, '', id: 'player_data', data: { id: @me.id, otp: @user.otp_required_for_login} %>
					<div id="otp_qrcode"></div>
					<div id="otp_confirm_form">
						<%= form_for :tfa_confirm, remote: true do |f| %>
							<%= f.text_field :otp, placeholder: "Enter OTP here"%>
						<% end %>
					</div>
					<div id="otp_disable_form">
						<%= form_for :tfa_disable, remote: true do |f| %>
							<%= f.text_field :otp, placeholder: "Enter OTP here"%>
						<% end %>
					</div>
					<button class="green_button" id="otp_confirm_button">Confirm OTP</button>
					<button class="green_button" id="otp_enable">Enable 2FA</button>
					<button class="green_button" id="otp_disable_button">Disable 2FA</button>
				</div>
			</div>
		<% end %>
		<div id="element">
			<div id="name">
				<h2>statistics</h2>
			</div>
			<div id="container">
				<div id="line">
					<p><span class="text-bold"><i class="fas fa-gamepad"></i> Games played :</span> <%= (@user_stat.victory + @user_stat.defeat) %></p>
				</div>
				<div id="line">
					<p><span class="text-bold text-green"><i class="fas fa-crown"></i> Victories :</span> <%= @user_stat.victory %></p>
				</div>
				<div id="line">
					<p><span class="text-bold text-red"><i class="fas fa-times"></i> Defeats :</span> <%= @user_stat.defeat %></p>
				</div>
				<div id="line">
					<p><span class="text-bold text-gold"><i class="fas fa-trophy"></i> Tournaments won :</span> <%= @user_stat.tournament %></p>
				</div>
			</div>
		</div>
		<% if @current == 1 || !(@me.friends.include?@user.id) || @admin == 1 %>
			<div id="element">
				<div id="name">
					<h2>actions</h2>
				</div>
				<% if @current == 1 || @admin == 1 %>
					<div class="element-line">
						<span>Available for war?</span>
						<label class="switch">
							<input id="user_available" type="checkbox" <%= @user.available == true ? "checked" : ""%>>
							<span class="slider"></span>
						</label>
					</div>
				<% end %>
				<div class="element-line" id="container">
				<% if (@current == 1 || @admin == 1) && @user.deleted == false %>
					<button class="back-red" id="delete_user" ><i class="fas fa-trash-alt"></i> Delete account</button><br/>
				<% end %>
				<% if (@admin == 1 && @user.banned == false) && @user.deleted == false %>
					<button class="back-red" id="ban_user" ><i class="fas fa-trash-alt"></i> Ban account</button><br/>
				<% elsif @admin == 1 && @user.banned == true %>
					<button class="back-red" id="unban_user" ><i class="fas fa-trash-alt"></i> Unban account</button><br/>
				<% end %>
				<% if @current != 1 && !(@me.friends.include?@user.id) && @user.deleted == false %>
					<button class="back-blue" id="add_friend" ><i class="fas fa-user-friends"></i> Add Friend</button>
				<% end %>
				</div>
			</div>
		<% end %>
		<div id="element">
			<div id="name">
				<h2>Friends</h2>
			</div>
			<div id="container">
				<% @user.friends.each do |friend_id| %>
					<% friend = User.find_by_id(friend_id); %>
					<% if friend != nil %>
						<div id="line">
							<% if friend.isOnline() == "online" %>
								<p><span class="text-bold text-green"><%= friend.nickname %></span><button id="del_friend" value="<%= friend.id %>"><i class="fas fa-times"></i></button></p>
								<button id="duel_game_user" class="back-green" value="<%= friend.id %>">Duel!</button>
								<%= form_for :tournaments do |f| %>
									<%= f.select :end, options_for_select(@tournament.map{|u| [u.name, u.id]}, :selected => 1) %>
								<% end %>
							<% elsif friend.isOnline() == "in_game" %>
								<p><span class="text-bold text-orange"><%= friend.nickname %></span><button id="del_friend" value="<%= friend.id %>"><i class="fas fa-times"></i></button></p>
								<button id="watch_game_user" class="back-green" value="<%= friend.findLiveGame() %>">Live</button>
							<% else %>
								<p><span class="text-bold text-red"> <%= friend.nickname %></span><button id="del_friend" value="<%= friend.id %>"><i class="fas fa-times"></i></button></p>
							<% end %>
						</div>
					<% end %>
				<% end %>
			</div>
		</div>
	</div>
	<% if @histories.count > 0 %>
		<div id="container-history">
			<div id="head">
				<h2>historique games</h2>
			</div>
			<div id="history">
				<% @histories.each do |history| %>
					<div id="game">
						<div id="icon">
							<% if (history.host_score > history.opponent_score) %>
							<i id="" class="fas fa-check"></i>
							<% else %>
							<i class="fas fa-times"></i>
							<% end %>
						</div>
						<div id="target">
							<p onClick="window.location='/#show_user/<%= history.host_id %>'"><%= User.find_by_id(history.host_id).nickname %></p>
						</div>
						<div id="target">
							<p onClick="window.location='/#show_user/<%= history.opponent_id %>'"><%= User.find_by_id(history.opponent_id).nickname %></p>
						</div>
						<div id="score">
							<p><%= history.host_score %> / <%= history.opponent_score %></p>
						</div>
					</div>
				<% end %>
			</div>
		</div>
	<% end %>
	<%= javascript_pack_tag 'show_hide_otp' %>
</div>